(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{225:function(e,t,n){},237:function(e,t,n){"use strict";n.r(t);var a=n(80),r=n.n(a),c=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,264)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},s=n(4),o=n(0),i=n(42),l=n(18),u=n(254),j=(n(224),n(225),n(17)),d=n(44),b=n(200),m={user:null};if(localStorage.getItem("jwtToken")){var O=Object(b.a)(localStorage.getItem("jwtToken"));1e3*O.exp<Date.now()?localStorage.removeItem("jwtToken"):m.user=O}var h=Object(o.createContext)({user:null,login:function(e){},logout:function(){}});function x(e,t){switch(t.type){case"LOGIN":return Object(d.a)(Object(d.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(d.a)(Object(d.a)({},e),{},{user:null});default:return e}}function p(e){var t=Object(o.useReducer)(x,m),n=Object(j.a)(t,2),a=n[0],r=n[1];return Object(s.jsx)(h.Provider,Object(d.a)({value:{user:a.user,login:function(e){localStorage.setItem("jwtToken",e.token),r({type:"LOGIN",payload:e})},logout:function(){localStorage.removeItem("jwtToken"),r({type:"LOGOUT"})}}},e))}var g=n(208);var f=function(e){var t=e.component,n=Object(g.a)(e,["component"]),a=Object(o.useContext)(h).user;return Object(s.jsx)(l.b,Object(d.a)(Object(d.a)({},n),{},{render:function(e){return a?Object(s.jsx)(l.a,{to:"/"}):Object(s.jsx)(t,Object(d.a)({},e))}}))},v=n(257);var C=function(){var e=Object(o.useContext)(h),t=e.user,n=e.logout,a=function(e,t){var n=t.name;return b(n)},r=window.location.pathname,c="/"===r?"home":r.substr(1),l=Object(o.useState)(c),u=Object(j.a)(l,2),d=u[0],b=u[1];return t?Object(s.jsxs)(v.a,{pointing:!0,secondary:!0,size:"massive",color:"blue",children:[Object(s.jsx)(v.a.Item,{name:"Inicio",active:"home"===d,onClick:a,as:i.b,to:"/"}),Object(s.jsx)(v.a.Menu,{position:"right",children:Object(s.jsx)(v.a.Item,{name:"Cerrar Sesi\xf3n",onClick:n})})]}):Object(s.jsxs)(v.a,{pointing:!0,secondary:!0,size:"massive",color:"blue",children:[Object(s.jsx)(v.a.Item,{name:"Inicio",active:"home"===d,onClick:a,as:i.b,to:"/"}),Object(s.jsxs)(v.a.Menu,{position:"right",children:[Object(s.jsx)(v.a.Item,{name:"Iniciar Sesi\xf3n",active:"login"===d,onClick:a,as:i.b,to:"/login"}),Object(s.jsx)(v.a.Item,{name:"Registrarse",active:"register"===d,onClick:a,as:i.b,to:"/registro"})]})]})},I=n(20),y=n(261),k=n(262),w=n(205),S=n(255),P=n(259),$=n(108),A=n(157),N=n(115),E=n.n(N),D=n(43),M=n(23),L=n.n(M);function T(){var e=Object(D.a)(["\n  mutation($postId: ID!, $body: String!) {\n    createComment(postId: $postId, body: $body) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentsCount\n    }\n  }\n"]);return T=function(){return e},e}function Q(){var e=Object(D.a)(["\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentsCount\n    }\n  }\n"]);return Q=function(){return e},e}function R(){var e=Object(D.a)(["\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n"]);return R=function(){return e},e}function F(){var e=Object(D.a)(["\n  query($postId: ID!) {\n    getPost(postId: $postId) {\n      id\n      body\n      createdAt\n      username\n      likesCount\n      likes {\n        username\n      }\n      commentsCount\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n    }\n  }\n"]);return F=function(){return e},e}function B(){var e=Object(D.a)(["\n  mutation likePost($postId: ID!) {\n    likePost(postId: $postId) {\n      id\n      likes {\n        id\n        username\n      }\n      likesCount\n    }\n  }\n"]);return B=function(){return e},e}function z(){var e=Object(D.a)(["\n  {\n    getAllPosts {\n      id\n      body\n      username\n      createdAt\n      commentsCount\n      comments {\n        id\n        createdAt\n        username\n        body\n      }\n      likesCount\n      likes {\n        id\n        createdAt\n        username\n      }\n    }\n  }\n"]);return z=function(){return e},e}var q=L()(z()),G=L()(B()),H=L()(F()),J=L()(R()),U=L()(Q()),V=L()(T());var W=function(e){var t=e.user,n=e.post,a=n.id,r=n.likesCount,c=n.likes,l=Object(o.useState)(!1),u=Object(j.a)(l,2),d=u[0],b=u[1];Object(o.useEffect)((function(){t&&c.find((function(e){return e.username===t.username}))?b(!0):b(!1)}),[t,c]);var m=Object(I.useMutation)(G,{variables:{postId:a}}),O=Object(j.a)(m,1)[0],h=t?d?Object(s.jsx)(S.a,{content:"Quitar like",inverted:!0,trigger:Object(s.jsx)(P.a,{color:"red",children:Object(s.jsx)($.a,{name:"heart"})})}):Object(s.jsx)(S.a,{content:"Dar like",inverted:!0,trigger:Object(s.jsx)(P.a,{color:"red",basic:!0,children:Object(s.jsx)($.a,{name:"heart"})})}):Object(s.jsx)(P.a,{as:i.b,to:"/login",color:"red",basic:!0,children:Object(s.jsx)($.a,{name:"heart"})});return Object(s.jsxs)(P.a,{as:"div",labelPosition:"right",onClick:O,children:[h,Object(s.jsx)(A.a,{as:"a",basic:!0,color:"red",pointing:"left",children:r})]})},K=n(258);var X=function(e){var t=e.postId,n=e.commentId,a=e.callback,r=Object(o.useState)(!1),c=Object(j.a)(r,2),i=c[0],l=c[1],u=n?U:J,d=Object(I.useMutation)(u,{refetchQueries:[{query:q}],update:function(e){l(!1),a&&a()},variables:{postId:t,commentId:n}}),b=Object(j.a)(d,1)[0];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(S.a,{content:n?"Eliminar comentario":"Eliminar publicaci\xf3n",inverted:!0,trigger:Object(s.jsx)(P.a,{as:"div",color:"red",floated:"right",onClick:function(){return l(!0)},children:Object(s.jsx)($.a,{name:"trash",style:{margin:0}})})}),Object(s.jsx)(K.a,{open:i,onCancel:function(){console.log(t),l(!1)},onConfirm:b})]})};var Y=function(e){var t=e.post,n=t.body,a=t.createdAt,r=t.id,c=t.username,l=t.likes,u=t.commentsCount,j=t.likesCount,d=Object(o.useContext)(h).user;return Object(s.jsxs)(k.a,{children:[Object(s.jsxs)(k.a.Content,{children:[Object(s.jsx)(w.a,{floated:"right",size:"mini",src:"https://react.semantic-ui.com/images/avatar/large/molly.png"}),Object(s.jsxs)(k.a.Header,{children:["@",c]}),Object(s.jsx)(k.a.Meta,{as:i.b,to:"/post/".concat(r),children:E()(a).fromNow()}),Object(s.jsx)(k.a.Description,{children:n})]}),Object(s.jsxs)(k.a.Content,{extra:!0,children:[Object(s.jsx)(S.a,{content:"Click para comentar",inverted:!0,trigger:Object(s.jsx)(W,{user:d,post:{id:r,likes:l,likesCount:j}})}),Object(s.jsxs)(P.a,{labelPosition:"right",as:i.b,to:"/post/".concat(r),children:[Object(s.jsx)(S.a,{content:"Comentar publicaci\xf3n",inverted:!0,trigger:Object(s.jsx)(P.a,{color:"blue",basic:!0,children:Object(s.jsx)($.a,{name:"comments"})})}),Object(s.jsx)(A.a,{as:"a",basic:!0,color:"blue",pointing:"left",children:u})]}),d&&d.username===c&&Object(s.jsx)(X,{postId:r})]})]})},Z=n(206),_=n(256),ee=n(129),te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(o.useState)(t),a=Object(j.a)(n,2),r=a[0],c=a[1],s=function(e){c(Object(d.a)(Object(d.a)({},r),{},Object(ee.a)({},e.target.name,e.target.value)))},i=function(t){t.preventDefault(),e()};return{onChange:s,onSubmit:i,values:r}};function ne(){var e=Object(D.a)(["\n  mutation createPost($body: String!) {\n    createPost(body: $body) {\n      id\n      username\n      body\n      createdAt\n      likes {\n        id\n        username\n        createdAt\n      }\n      likesCount\n      comments {\n        id\n        body\n        username\n        createdAt\n      }\n      commentsCount\n    }\n  }\n"]);return ne=function(){return e},e}var ae=L()(ne()),re=function(){var e=te((function(){o()}),{body:""}),t=e.values,n=e.onChange,a=e.onSubmit,r=Object(I.useMutation)(ae,{variables:t,update:function(e,n){var a=e.readQuery({query:q});e.writeQuery({query:q,data:{getAllPosts:[n.data.createPost].concat(Object(Z.a)(a.getAllPosts))}}),t.body=""},onError:function(e){console.log(e)}}),c=Object(j.a)(r,2),o=c[0],i=c[1].error;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(_.a,{onSubmit:a,children:[Object(s.jsx)(u.a,{textAlign:"justified",style:{marginBottom:20},children:Object(s.jsx)("h2",{children:"Crea una nueva publicacion"})}),Object(s.jsxs)(_.a.Field,{children:[Object(s.jsx)(_.a.Input,{placeholder:"Saluda a tus amigos!",name:"body",onChange:n,value:t.body,error:!!i}),Object(s.jsx)(u.a,{textAlign:"right",children:Object(s.jsx)(P.a,{type:"submit",color:"orange",children:"Publicar"})})]})]}),i&&Object(s.jsx)("div",{className:"ui error message",style:{marginBottom:20},children:Object(s.jsx)("ul",{className:"list",children:Object(s.jsx)("li",{children:i.graphQLErrors[0].message})})})]})};var ce=function(){var e=Object(o.useContext)(h).user,t=Object(I.useQuery)(q),n=t.loading,a=t.data,r=(a=void 0===a?{}:a).getAllPosts;return Object(s.jsxs)(y.a,{columns:3,children:[Object(s.jsx)(y.a.Row,{children:Object(s.jsx)(u.a,{textAlign:"center",children:Object(s.jsx)("h1",{children:"Publicaciones Recientes"})})}),Object(s.jsxs)(y.a.Row,{children:[Object(s.jsx)(y.a.Column,{children:e&&Object(s.jsx)(y.a.Column,{children:Object(s.jsx)(re,{})})}),n?Object(s.jsx)("h1",{children:" Cargando..."}):r&&r.map((function(e){return Object(s.jsx)(y.a.Column,{style:{marginBottom:20},children:Object(s.jsx)(Y,{post:e})},e.id)}))]})]})};function se(){var e=Object(D.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      id\n      email\n      username\n      createdAt\n      token\n    }\n  }\n"]);return se=function(){return e},e}var oe=L()(se()),ie=function(e){var t=Object(o.useContext)(h),n=Object(o.useState)({}),a=Object(j.a)(n,2),r=a[0],c=a[1],i=te((function(){O()}),{username:"",password:""}),l=i.onChange,u=i.onSubmit,d=i.values,b=Object(I.useMutation)(oe,{update:function(n,a){var r=a.data.login;t.login(r),e.history.push("/")},onError:function(e){c(e.graphQLErrors[0].extensions.errors)},variables:d}),m=Object(j.a)(b,2),O=m[0],x=m[1].loading;return Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsxs)(_.a,{onSubmit:u,noValidate:!0,className:x?"loading":"",children:[Object(s.jsx)("h1",{children:"Iniciar Sesi\xf3n"}),Object(s.jsx)(_.a.Input,{label:"Nombre de usuario",placeholder:"Nombre de usuario..",name:"username",type:"text",value:d.username,error:!!r.username,onChange:l}),Object(s.jsx)(_.a.Input,{label:"Contrase\xf1a",placeholder:"Contrase\xf1a..",name:"password",type:"password",value:d.password,error:!!r.password,onChange:l}),Object(s.jsx)(P.a,{type:"submit",primary:!0,children:"Iniciar Sesi\xf3n"})]}),Object.keys(r).length>0&&Object(s.jsx)("div",{className:"ui error message",children:Object(s.jsx)("ul",{className:"list",children:Object.values(r).map((function(e){return Object(s.jsx)("li",{children:e},e)}))})})]})};function le(){var e=Object(D.a)(["\n  mutation register(\n    $username: String!\n    $email: String!\n    $password: String!\n    $confirmPassword: String!\n  ) {\n    register(\n      registerInput: {\n        username: $username\n        email: $email\n        password: $password\n        confirmPassword: $confirmPassword\n      }\n    ) {\n      id\n      email\n      username\n      createdAt\n      token\n    }\n  }\n"]);return le=function(){return e},e}var ue=L()(le()),je=function(e){var t=Object(o.useContext)(h),n=Object(o.useState)({}),a=Object(j.a)(n,2),r=a[0],c=a[1],i=te((function(){O()}),{username:"",email:"",password:"",confirmPassword:""}),l=i.onChange,u=i.onSubmit,d=i.values,b=Object(I.useMutation)(ue,{update:function(n,a){var r=a.data.register;t.login(r),e.history.push("/")},onError:function(e){c(e.graphQLErrors[0].extensions.errors)},variables:d}),m=Object(j.a)(b,2),O=m[0],x=m[1].loading;return Object(s.jsxs)("div",{className:"form-container",children:[Object(s.jsxs)(_.a,{onSubmit:u,noValidate:!0,className:x?"loading":"",children:[Object(s.jsx)("h1",{children:"Crear una cuenta"}),Object(s.jsx)(_.a.Input,{label:"Nombre de usuario",placeholder:"Nombre de usuario..",name:"username",type:"text",value:d.username,error:!!r.username,onChange:l}),Object(s.jsx)(_.a.Input,{label:"Email",placeholder:"Email..",name:"email",type:"email",value:d.email,error:!!r.email,onChange:l}),Object(s.jsx)(_.a.Input,{label:"Contrase\xf1a",placeholder:"Contrase\xf1a..",name:"password",type:"password",value:d.password,error:!!r.password,onChange:l}),Object(s.jsx)(_.a.Input,{label:"Confirmar Contrase\xf1a",placeholder:"Confirmar Contrase\xf1a..",name:"confirmPassword",type:"password",value:d.confirmPassword,error:!!r.confirmPassword,onChange:l}),Object(s.jsx)(P.a,{type:"submit",primary:!0,children:"Registrarse!"})]}),Object.keys(r).length>0&&Object(s.jsx)("div",{className:"ui error message",children:Object(s.jsx)("ul",{className:"list",children:Object.values(r).map((function(e){return Object(s.jsx)("li",{children:e},e)}))})})]})},de=n(166),be=n(153);var me=function(e){var t,n=e.match.params.postId,a=Object(o.useContext)(h).user,r=Object(o.useRef)(null),c=Object(o.useState)(""),i=Object(j.a)(c,2),l=i[0],u=i[1],d=Object(I.useQuery)(H,{variables:{postId:n}}).data,b=(d=void 0===d?{}:d).getPost,m=Object(I.useMutation)(V,{update:function(){u(""),r.current.blur()},variables:{postId:n,body:l}}),O=Object(j.a)(m,1)[0];if(b){var x=b.id,p=b.body,g=b.createdAt,f=b.username,v=b.comments,C=b.likes,S=b.likesCount,N=b.commentsCount;t=Object(s.jsx)(y.a,{children:Object(s.jsxs)(y.a.Row,{children:[Object(s.jsx)(y.a.Column,{width:"2",children:Object(s.jsx)(w.a,{src:"https://react.semantic-ui.com/images/avatar/large/molly.png",size:"small",float:"right"})}),Object(s.jsxs)(y.a.Column,{width:"10",children:[Object(s.jsxs)(k.a,{fluid:!0,children:[Object(s.jsxs)(k.a.Content,{children:[Object(s.jsxs)(k.a.Header,{children:["@",f]}),Object(s.jsx)(k.a.Meta,{children:E()(g).fromNow()}),Object(s.jsx)(k.a.Description,{children:p})]}),Object(s.jsx)("hr",{}),Object(s.jsxs)(k.a.Content,{extra:!0,children:[Object(s.jsx)(W,{user:a,post:{id:x,likesCount:S,likes:C}}),Object(s.jsxs)(P.a,{as:"div",labelPosition:"right",onClick:function(){return console.log("comentando")},children:[Object(s.jsx)(P.a,{basic:!0,color:"blue",children:Object(s.jsx)($.a,{name:"comments"})}),Object(s.jsx)(A.a,{basic:!0,color:"blue",pointing:"left",children:N})]}),a&&a.username===f&&Object(s.jsx)(X,{postId:x,callback:function(){e.history.push("/")}})]})]}),a&&Object(s.jsx)(k.a,{fluid:!0,children:Object(s.jsx)(de.a,{children:Object(s.jsx)(_.a,{children:Object(s.jsxs)("div",{className:"ui action input fluid",children:[Object(s.jsx)("input",{type:"text",placeholder:"Escribe un comentario..",name:"comment",value:l,onChange:function(e){return u(e.target.value)},ref:r}),Object(s.jsx)("button",{type:"submit",className:"ui button blue",disabled:""===l.trim(),onClick:O,children:"Enviar"})]})})})}),v.map((function(e){return Object(s.jsx)(k.a,{fluid:!0,children:Object(s.jsxs)(de.a,{children:[a&&a.username===e.username&&Object(s.jsx)(X,{postId:x,commentId:e.id}),Object(s.jsx)(be.a,{children:Object(s.jsxs)("p",{children:["@",e.username]})}),Object(s.jsx)(k.a.Meta,{children:E()(e.createdAt).fromNow()}),Object(s.jsx)(k.a.Description,{children:Object(s.jsx)("p",{style:{fontWeight:"bold"},children:e.body})})]})},e.id)}))]})]})})}else t=Object(s.jsx)("p",{children:"Loading post..."});return t};var Oe=function(){return Object(s.jsx)(p,{children:Object(s.jsx)(i.a,{children:Object(s.jsxs)(u.a,{children:[Object(s.jsx)(C,{}),Object(s.jsx)(l.b,{exact:!0,path:"/",component:ce}),Object(s.jsx)(f,{exact:!0,path:"/login",component:ie}),Object(s.jsx)(f,{exact:!0,path:"/registro",component:je}),Object(s.jsx)(l.b,{exact:!0,path:"/post/:postId",component:me})]})})})},he=n(207),xe=Object(I.createHttpLink)({uri:" https://protected-waters-59335.herokuapp.com/"}),pe=Object(he.a)((function(){var e=localStorage.getItem("jwtToken");return{headers:{Authorization:e?"Bearer ".concat(e):""}}})),ge=new I.ApolloClient({link:pe.concat(xe),cache:new I.InMemoryCache}),fe=Object(s.jsx)(I.ApolloProvider,{client:ge,children:Object(s.jsx)(Oe,{})});r.a.render(fe,document.getElementById("root")),c()}},[[237,1,2]]]);
//# sourceMappingURL=main.c5f76b2f.chunk.js.map